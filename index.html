<!DOCTYPE html>
<html lang="en">

<head>
    <title>Height Mapper</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
    body {
        margin: 0px;
        background-color: #000000;
        overflow: hidden;
    }
    
    canvas {
        width: 100%;
        height: 100%;
        background-color: #181818;
    }
    
    div.mdl-switch__track {
        background: rgba(242, 242, 242, 0.26)
    }
    </style>
    <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.green-blue.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script>
</head>

<body>
    <button class="mdl-button mdl-js-button mdl-button--primary" id="new_plot" style="top: 10px; left: 10px; position:absolute; color:white" onclick="showDialog()">New Plot</button>
    <div style="top: 16px; right: 12px; position:absolute; width: 98px;">

    <label class="mdl-switch mdl-js-switch" for="vis_type">
	    <span class="mdl-switch__label" style="color:white; margin-left: -178px; margin-right: 60px;">Bathymetry Map</span>
      <input type="checkbox" id="vis_type" class="mdl-switch__input" onclick="toggleColors()">
      <span class="mdl-switch__label" style="color:white">Dive</span>
    </label>
    </div>
    <div class="new-plot-window mdl-card mdl-shadow--2dp" id="dialog" style="position: absolute; top: 50px; left: 10px;z-index:10000 ">

        <textarea type="text" rows="8" id="new_data" placeholder="Paste height data here..." style="height:100%; border:0px; padding:12px"></textarea>

        <div class="mdl-card__actions mdl-card--border">

<!-- Left aligned menu below button -->
<button id="demo-menu-lower-left" class="mdl-button mdl-js-button">
  <img class="material-icons" src="./ic_settings_black_24px.svg"/>
  <span>options<span>
</button>

<ul class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect"
    for="demo-menu-lower-left">
  <li class="mdl-menu__item">Some Action</li>
  <li class="mdl-menu__item mdl-menu__item--full-bleed-divider">Another Action</li>
  <li disabled class="mdl-menu__item">Disabled Action</li>
  <li class="mdl-menu__item">Yet Another Action</li>
</ul>
<!--<label class="mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect" for="reverse_data" style="float:left; width: 20px; margin: 6px;">-->
<!--  <input type="checkbox" id="reverse_data" class="mdl-checkbox__input">-->
<!--  <span class="mdl-checkbox__label">Reverse Plot</span>-->
<!--</label>-->

    <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="updateTerrain()" style="margin: 0 auto; float: right;">
      Plot it!
    </a>
        </div>
    </div>
    <script id="frag" type="x-shader/x-fragment">
#define PHYSICAL
uniform vec3 diffuseOriginal;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
uniform float envMapIntensity;
varying vec3 vViewPosition;
varying vec3 vPosition;
varying vec3 vQPos;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif

vec3 diffuse = vec3(0.9,0.9,0.9);
#include <common>
#include <packing>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <lights_pars>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
  
  vec3 white = vec3(1.0, 1.0, 1.0);
	vec3 red = vec3(1.0, 0.0, 0.0);
	vec3 green = vec3(0.0, 1.0, 0.0);
	vec3 violet = vec3(0.25, 0.1, 0.75);
	vec3 blueBlue = vec3(0.0, 0.5, 1.0);
	vec3 blueGreen = vec3(0.0, 0.9, 0.5);
	vec3 purple = vec3(0.8, 0.0, 0.2);
	vec3 greenRed = vec3(1.0, 1.0, 0.0);
  
  float zstart = -vQPos.y - float(0.25);
  
  vec3 gpurple = (smoothstep(0.25, 0.75, zstart + float(1)) - smoothstep(0.25, 0.75, zstart + float(0.5))) * purple;
  vec3 gviolet = (smoothstep(0.25, 0.75, zstart + float(0.5)) - smoothstep(0.25, 0.75, zstart + float(0))) * violet;
  vec3 gblueBlue = (smoothstep(0.25, 0.75, zstart - float(0)) - smoothstep(0.25, 0.75, zstart - float(0.5))) * blueBlue;
  vec3 gblueGreen = (smoothstep(0.25, 0.75, zstart - float(0.5)) - smoothstep(0.25, 0.75, zstart - float(1))) * blueGreen;
  vec3 ggreen = (smoothstep(0.25, 0.75, zstart - float(1)) - smoothstep(0.25, 0.75, zstart - float(1.5))) * green;
  vec3 ggreenred = (smoothstep(0.25, 0.75, zstart - float(1.5)) - smoothstep(0.25, 0.75, zstart - float(2))) * greenRed;
  vec3 gred = (smoothstep(0.25, 0.75, zstart - float(2)) - smoothstep(0.25, 0.75, zstart - float(2.5))) * red;
  diffuse = gpurple + gviolet + gblueBlue + gblueGreen + ggreen + ggreenred + red;

	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_template>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}
    </script>
    <script id="vert" type="x-shader/x-fragment">
#define PHYSICAL
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
varying vec3 vPosition;
varying vec3 worldPosition;
varying vec3 vQPos;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <displacementmap_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	vQPos = - worldPosition.xyz;
	#include <shadowmap_vertex>
	
}
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/threejs/r76/three.min.js"></script>
    <script src="http://mrdoob.github.com/three.js/examples/js/shaders/CopyShader.js"></script>
		<script src="http://mrdoob.github.com/three.js/examples/js/shaders/SSAOShader.js"></script>
		
		<script src="http://mrdoob.github.com/three.js/examples/js/postprocessing/EffectComposer.js"></script>
		<script src="http://mrdoob.github.com/three.js/examples/js/postprocessing/RenderPass.js"></script>
		<script src="http://mrdoob.github.com/three.js/examples/js/postprocessing/MaskPass.js"></script>
		<script src="http://mrdoob.github.com/three.js/examples/js/postprocessing/ShaderPass.js"></script>

    <script src="./firstperson.js"></script>
    
    <script src="./subdivision.js"></script>

    <script src="./script.js"></script>
</body>

</html>